/*!
 * jQuery smartScroll v1.1.0
 * https://github.com/happytodesign/smartScroll
 *
 * Copyright 2013 happytodesign.com (mailbox@happytodesign.com)
 * Released under the MIT license
 *
 * Date: 2013-05-15
 */!function(e,t){function r(r,i){this.element=r;this.options=e.extend(n,i);this._window=e(t);this._init()}var n={offset:0,activeClass:"active",parent:"",filter:"",hash:!1,speed:"relative",easing:"swing",activate:function(){},scrollStart:function(){},scrollEnd:function(){}};r.prototype={refresh:function(){this.element.ids=[];this._offsets={};var t=this,n=e(this.element).find('a[href^="#"]');this.options.filter.length&&(n=n.filter(this.options.filter));n.map(function(){var n=this.getAttribute("href"),r=e(n).length&&e(n);return r&&[[n,[r.offset().top-t.options.offset,r.offset().top+r.outerHeight(!0)-t.options.offset]]]||null}).each(function(){t.element.ids.push(this[0]);t._offsets[this[0]]=this[1]})},_init:function(){this.refresh();this._monitor();this._smoothScroll();var t=this._window,n=this,r=e.proxy(this.refresh,this);t.on("scroll.smartScroll",e.proxy(this._monitor,this));t.on("mousedown.smartScroll mousewheel.smartScroll keyup.smartScroll",function(){if(n._scrolling){n._scrolling=!1;e("html, body").stop()}});t.on("resize.smartScroll",function(){clearTimeout(this._refreshTimer);this._refreshTimer=setTimeout(function(){r()},25)})},_monitor:function(){if(!this._scrolling){var t,n=this.element.ids,r=this._offsets,i=this._window.scrollTop();for(var s=n.length;s--;){var o=n[s];if(i>=r[o][0]&&i<=r[o][1]){e('a[href="'+t+'"]').trigger("click");t=o;break}}t?this._activate(t):this._activate()}},_activate:function(n){if(this.element.current!=n){var r=this.element.previous=this.element.current,i=this.element.current=n,s=this.options.parent||"a",o=this.options.activeClass||"active";undefined!=r&&e(this.element).find('a[href="'+r+'"]').closest(s).removeClass(o);undefined!=i&&e(this.element).find('a[href="'+i+'"]').closest(s).addClass(o);if(this.options.hash){var u=i;undefined==u&&(u=t.location.pathname);u+=t.location.search;clearTimeout(this._hashTimer);this._hashTimer=setTimeout(function(){history.replaceState({},"",u)},250)}this.options.activate(this.element)}},_smoothScroll:function(){var t=this;e(this.element).on("click",'a[href="'+this.element.ids.join('"], a[href="')+'"]',function(n){n.preventDefault();t._scrolling=!0;t.options.scrollStart();var r=this.getAttribute("href"),i="relative"==t.options.speed&&Math.abs(t._offsets[r][0]-t.options.offset-t._window.scrollTop())||t.options.speed;t._activate(r);e("html, body").stop().animate({scrollTop:t._offsets[r][0]},i,t.options.easing,function(){t._scrolling=!1;t.options.scrollEnd()})})}};e.fn.smartScroll=function(e){return this.each(function(){new r(this,e)})}}(jQuery,window);